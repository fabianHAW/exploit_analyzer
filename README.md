This is a software to analyze exploits from the [Exploit Database](https://www.exploit-db.com/).

# Requirements

This software was tested on Debian Stretch 9.6 and is written in Python 2.7.13 

## Install MongoDB

`apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 9DA31620334BD75D9DCB49F368818C72E52529D4`

`echo "deb http://repo.mongodb.org/apt/debian stretch/mongodb-org/4.0 main" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.0.list`

`apt update`

`apt install -y mongodb-org`

## Install virtualenv (optional)

`mkvirtualenv --system-site-packages --python=<path-to-python2.7-bin> <env-name>`

`add2virtualenv <path-to-this-repo>i/src`

In any case the requirements installation is required:

`pip install -r requirements.txt`

# Init

MongoDB runs on `localhost:27017`.

`systemctl start mongod.service`

If you want to change the name of database or collection in `mongodb_setup.js`, you need to change it in `database/db_interface.py` as well. By default it inits the MongoDB with the database `exploitdb` and the collection `exploits`. 

`mongo < mongodb_setup.js`

# HowTo

## Config

Configuration settings are stored in `conf/config.cfg`. The configuration settings for the test cases are stored in `conf/test_config.cfg`.
**Important:** You need to change the paths in this files! E.g. change `<path-to-a-dir-to-store-the-comment-files>` to something like `/home/user/exploitdb_sep/` or `<path-to-this-repo-root>` to `/home/user/exploit_analyzer`. 

## Run

The Exploit-Fetcher component downloads the exploits from the [Exploit Database](https://www.exploit-db.com/) and stores them to the path which is specified in `local_git` in the config-file as well as in the MongoDB. Afterwards it iterates over the exploits and separates them in code and comments and stores them to a dedicated dir. Then it analyzes the comment and code files.

`python2.7 -m main`

## Logging

Log files are stored in `log/`. The logging config is stored in `conf/logging.cfg`. No changes need to do here.

## Generate Statistics

It needs the exploitdb repo stored at `local_git` in the config file`. At section `[visualization]` is the path to store the assets. While running it plots various statistics to the asset dir.

`python2.7 -m visualization.aggregation`

## Test

`pytest test/`

# Doc

## Architecture

In `doc/arch/` is the main architecture of the system. `arch_single.xml`is the architecture of this component named "Exploit Information Retrieval". `arch.xml` is the hole idea of a system including two other components: "Exploit Execution" and "Exploit Detection" which are not part of this project. The xml-Files were created with [Draw.io](https://www.draw.io/).
`arch.vpp` is a VisualParadigm project which includes more detailed diagrams about this project. `doc/arch/diagrams.pdf` gives a quick view about it.

## Specification

In `doc/spec/` is a latex document which describes the specification. In this dir run `make` to generate the pdf-file.

## Data Format
In `doc/arch/diagrams.pdf` are the data formats documented which are processed.
