import pytest
import mock

from configparser import ConfigParser

from exploit_analyzer.exploitdb.exploit_separator import Separator


@pytest.fixture
def config_parser_mock():
    with mock.patch('exploit_analyzer.exploitdb.exploit_separator.get_config_parser') \
            as config_parser_mock:
        parser = ConfigParser()
        parser.read('conf/test_config.cfg')
        config_parser_mock.return_value = parser
        yield config_parser_mock


@pytest.fixture
def python_separator(config_parser_mock):
    return Separator.create_separator('python', mock.Mock())


@pytest.fixture
def separator_exploit_dir(config_parser_mock):
    return config_parser_mock().get('git', 'local_git')


@pytest.fixture
def separator_comment_dir(config_parser_mock):
    return config_parser_mock().get('separator', 'comment_dir')


@pytest.fixture
def separator_code_dir(config_parser_mock):
    return config_parser_mock().get('separator', 'code_dir')


@pytest.fixture
def separator_quarantine_dir(config_parser_mock):
    return config_parser_mock().get('separator', 'quarantine_dir')
