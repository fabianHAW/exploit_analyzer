from utils import utils


class TestUtils(object):
    def test_merge_results(self, results):
        all_results = utils.merge_results(results[0], results[1])
        assert sorted(all_results['exploit.py']['cve']) == sorted(
            [
                'cve-1234-5678', 'cve-9876-5432'
            ])
        assert sorted(all_results['exploit.py']['ip']) == sorted(
            [
                '1.1.1.1', '2.2.2.2'
            ])

    def test_del_multiple_emails(self, email_results):
        utils.del_multiple_emails(email_results)
        assert sorted(email_results['exploit.py']['additional_emails']) == \
            sorted(['foobar@barfoo.de'])
        assert sorted(email_results['exploit.py']['email']) == \
            sorted(['foo@bar.de', 'bar@foo.de'])

    def test_del_multiple_urls(self, url_results):
        utils.del_multiple_urls(url_results)
        assert sorted(url_results['exploit.py']['additional_urls']) == \
            sorted(['http://www.foobar.barfoo'])
        assert sorted(url_results['exploit.py']['software link']) == \
            sorted(['www.foo.bar'])
        assert sorted(url_results['exploit.py']['vendor homepage']) == \
            sorted(['www.bar.foo'])
