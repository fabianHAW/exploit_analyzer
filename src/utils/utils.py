def merge_results(result1, result2):
    """
    {path: {
            cve: [..],
            ip: [..],
            }
    """
    merge = {}
    # we know that every filename is represented in both dictionaries
    for filename, info_dict1 in result1.items():
        merge.setdefault(filename, {})
        info_dict2 = result2[filename]
        # param := cve, ip, ...
        # val1/val2 := list of values to the param
        for param, val1 in info_dict1.items():
            val2 = info_dict2.get(param, [])
            val1_set = set(val1)
            merge_dict = merge.setdefault(filename, {})
            merge_dict[param] = list(val1_set.union(val2))
        for param, val2 in info_dict2.items():
            val1 = info_dict1.get(param, [])
            val2_set = set(val2)
            merge_dict = merge.setdefault(filename, {})
            merge_dict[param] = list(val2_set.union(val1))

    return merge
